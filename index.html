<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>[SCRIBD] Downloader</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>[SCRIBD] Downloader</h1>
    <input type="text" id="inputUrl" placeholder="Paste Scribd URL here" />
    <button onclick="convertUrl()">Download</button>

    <div class="result-section" id="resultSection" style="display: none;">
      <p>Your document is ready</p>
      <p><span id="docTitle">title for document is here</span> | <a id="downloadLink" href="#" target="_blank">download</a></p>
    </div>

    <div class="recent-section" id="recentSection" style="display: none;">
      <h3>recent documents downloaded</h3>
      <table>
        <thead>
          <tr>
            <th>no</th>
            <th>title</th>
            <th>link</th>
          </tr>
        </thead>
        <tbody id="recentTableBody">
          <!-- JavaScript will insert recent rows -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
let recentDocs = JSON.parse(localStorage.getItem('recentDocs')) || [];

function convertUrl() {
    const inputUrl = document.getElementById('inputUrl').value.trim();
    const baseUrl = 'https://ilide.info/docgeneratev2?fileurl=https://scribd.vdownloaders.com/pdownload/';

    const match = inputUrl.match(/\/(doc|document|presentation)\/(\d+)\/([\w-]+)/);

    if (match) {
        const [, type, id, slug] = match;

        const title = slug.replace(/-/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
        const convertedUrl = `${baseUrl}${id}/${slug}`;

        document.getElementById('docTitle').textContent = title;
        const link = document.getElementById('downloadLink');
        link.href = convertedUrl;
        link.textContent = 'download';
        document.getElementById('resultSection').style.display = 'block';

        // Update recent documents
        recentDocs.unshift({ title, link: convertedUrl });
        recentDocs = recentDocs.slice(0, 10);
        localStorage.setItem('recentDocs', JSON.stringify(recentDocs));

        updateRecentTable();
    } else {
        alert('Invalid URL format');
    }

    document.getElementById('inputUrl').value = '';
}

function updateRecentTable() {
    const tableBody = document.getElementById('recentTableBody');
    tableBody.innerHTML = '';

    if (recentDocs.length > 0) {
        document.getElementById('recentSection').style.display = 'block';
        recentDocs.forEach((doc, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${index + 1}</td>
                <td>${doc.title}</td>
                <td><a href="${doc.link}" target="_blank">download</a></td>
            `;
            tableBody.appendChild(row);
        });
    } else {
        document.getElementById('recentSection').style.display = 'none';
    }
}

// â± Show table on page load if data exists
window.onload = () => {
    updateRecentTable();
};
</script>
</body>
</html>
